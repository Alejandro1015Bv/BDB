<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partituras para Trompeta</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <header>
        <h1>Partituras para Trompeta</h1>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="saxofon.html">Saxofón</a></li>
            <li><a href="clarinete.html">Clarinetes</a></li>
            <li><a href="bajo.html">Bajo y Trombón</a></li>
            <li><a href="trompeta.html">Trompetas</a></li>
            <li><a href="liras.html">Liras</a></li>
            <li class="admin-link"><a href="agregar_partituras.html">Agregar Partituras</a></li>
        </ul>
    </nav>

    <main>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Buscar partitura por título...">
            <button onclick="buscarPartituras()">Buscar</button>
        </div>

        <section class="partituras-list" id="partituras-container">
            <h2>Músicas Bailables</h2>
            <p id="no-bailables"></p>
            <div id="bailables-container"></div>
            
            <div class="separator"></div>

            <h2>Marchas</h2>
            <p id="no-marchas"></p>
            <div id="marchas-container"></div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Banda Estudiantil del Colegio Don Bosco. Todos los derechos reservados.</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Configuración de Firebase que proporcionaste
        const firebaseConfig = {
            apiKey: "AIzaSyCMtWMlW_JFRVBcAldePw8FsnMgbRJcfuE",
            authDomain: "banda-estudiantil.firebaseapp.com",
            projectId: "banda-estudiantil",
            storageBucket: "banda-estudiantil.firebasestorage.app",
            messagingSenderId: "1021301143534",
            appId: "1:1021301143534:web:b47627a8ea2f15e30900ff",
        };
        
        // Inicializar Firebase y Firestore
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // **Importante:** Cambia el valor de esta variable en cada archivo
        const instrumento = 'trompeta'; // Cambiar en cada archivo

        // Función para cargar las partituras
        async function cargarPartituras() {
            const bailablesContainer = document.getElementById('bailables-container');
            const marchasContainer = document.getElementById('marchas-container');
            
            bailablesContainer.innerHTML = '';
            marchasContainer.innerHTML = '';

            try {
                const q = query(collection(db, "partituras"), where("instrumento", "==", instrumento));
                const querySnapshot = await getDocs(q);

                let bailables = [];
                let marchas = [];

                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    if (data.tipo === 'bailables') {
                        bailables.push(data);
                    } else if (data.tipo === 'marchas') {
                        marchas.push(data);
                    }
                });

                // Renderizar partituras bailables
                if (bailables.length > 0) {
                    bailables.sort((a, b) => a.numero - b.numero);
                    bailables.forEach(p => {
                        bailablesContainer.innerHTML += `
                            <div class="partitura-card" data-titulo="${p.titulo}">
                                <p><strong>N° ${p.numero}</strong></p>
                                <h3>${p.titulo}</h3>
                                <img src="${p.url}" alt="Partitura de ${p.titulo}">
                            </div>
                            <div class="separator"></div>
                        `;
                    });
                } else {
                    document.getElementById('no-bailables').textContent = 'No hay partituras de música bailable para este instrumento.';
                }

                // Renderizar partituras de marchas
                if (marchas.length > 0) {
                     marchas.sort((a, b) => a.numero - b.numero);
                    marchas.forEach(p => {
                        marchasContainer.innerHTML += `
                            <div class="partitura-card" data-titulo="${p.titulo}">
                                <p><strong>N° ${p.numero}</strong></p>
                                <h3>${p.titulo}</h3>
                                <img src="${p.url}" alt="Partitura de ${p.titulo}">
                            </div>
                            <div class="separator"></div>
                        `;
                    });
                } else {
                    document.getElementById('no-marchas').textContent = 'No hay partituras de marchas para este instrumento.';
                }

            } catch (error) {
                console.error("Error al cargar las partituras: ", error);
            }
        }
        
        cargarPartituras();
        
        function buscarPartituras() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const items = document.querySelectorAll('.partitura-card');
            items.forEach(item => {
                const titulo = item.dataset.titulo.toLowerCase();
                if (titulo.includes(input)) {
                    item.style.display = 'block';
                    if (item.nextElementSibling && item.nextElementSibling.classList.contains('separator')) {
                        item.nextElementSibling.style.display = 'block';
                    }
                } else {
                    item.style.display = 'none';
                    if (item.nextElementSibling && item.nextElementSibling.classList.contains('separator')) {
                        item.nextElementSibling.style.display = 'none';
                    }
                }
            });
        }
    </script>
</body>
</html>